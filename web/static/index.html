<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pt-tools ç®¡ç†</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <header>
    <h1><a href="https://github.com/sunerpy/pt-tools" target="_blank" rel="noopener noreferrer">pt-tools</a></h1>
    <nav>
      <a href="#global">å…¨å±€è®¾ç½®</a>
      <a href="#qbit">qBittorrent</a>
      <a href="#sites">ç«™ç‚¹ä¸RSS</a>
      <a href="#tasks">ä»»åŠ¡åˆ—è¡¨</a>
      <a href="#logs">æ—¥å¿—</a>
      <a href="#password">ä¿®æ”¹å¯†ç </a>
      <a href="/logout">é€€å‡º</a>
    </nav>
    <div class="theme-toggle">
      <button id="themeSwitch" class="icon-btn" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
      <button id="btnStopAll" class="icon-btn" title="ä¸€é”®åœæ­¢æ‰€æœ‰ä»»åŠ¡">â¹ï¸ åœæ­¢ä»»åŠ¡</button>
      <button id="btnStartAll" class="icon-btn" title="ä¸€é”®å¯åŠ¨æ‰€æœ‰ä»»åŠ¡">â–¶ï¸ å¯åŠ¨ä»»åŠ¡</button>
    </div>
  </header>
  <main id="app"></main>
  <script src="/static/ui.js"></script>
  <script>
    const sw = document.getElementById('themeSwitch');
    const saved = localStorage.getItem('theme')||'dark';
    if(saved==='light'){ document.body.classList.add('light') }
    sw.onclick = ()=>{ const isLight = document.body.classList.toggle('light'); localStorage.setItem('theme', isLight? 'light':'dark'); };
    // é¡¶æ ä¸€é”®æ§åˆ¶
    const btnStop = document.getElementById('btnStopAll');
    const btnStart = document.getElementById('btnStartAll');
    let busy = false;
    btnStop.onclick = async ()=>{
      if(busy) return; busy = true; btnStop.disabled=true;
      try { await api('/api/control/stop',{method:'POST'}); alert('å·²åœæ­¢æ‰€æœ‰ä»»åŠ¡'); } catch(e){ alert('æ“ä½œå¤±è´¥: '+e.message) }
      btnStop.disabled=false; busy=false;
    };
    btnStart.onclick = async ()=>{
      if(busy) return; busy = true; btnStart.disabled=true;
      try { await api('/api/control/start',{method:'POST'}); alert('å·²å¯åŠ¨æ‰€æœ‰ä»»åŠ¡'); } catch(e){ alert('æ“ä½œå¤±è´¥: '+e.message) }
      btnStart.disabled=false; busy=false;
    };
  </script>
</body>
</html>