# RSS 订阅配置指南

本文档详细介绍了如何在 pt-tools 中配置 RSS 订阅，实现 PT 站点的自动化下载。

[返回首页](../../README.md)

## 目录

- [什么是 RSS 订阅](#什么是-rss-订阅)
- [获取 RSS 链接](#获取-rss-链接)
  - [NexusPHP 架构站点 (如 HDSky, HDDolby)](#nexusphp-架构站点-如-hdsky-hddolby)
  - [mTorrent 架构站点 (如 M-Team)](#mtorrent-架构站点-如-m-team)
- [在 pt-tools 中配置 RSS](#在-pt-tools-中配置-rss)
- [配置选项详解](#配置选项详解)
- [最佳实践](#最佳实践)
- [常见问题排查](#常见问题排查)

## 什么是 RSS 订阅

RSS (Really Simple Syndication) 是一种网络内容聚合格式。在 PT (Private Tracker) 站点中，RSS 用于发布最新的种子信息。

通过配置 RSS 订阅，pt-tools 可以：

1. 定期检查站点发布的最新种子
2. 根据预设的规则（如标题关键词、大小、免费状态等）自动过滤
3. 将符合条件的种子自动推送到下载器（如 qBittorrent, Transmission）

这是实现"全自动刷流"和"自动追剧"的核心功能。

## 获取 RSS 链接

不同的 PT 站点架构，获取 RSS 链接的方式略有不同。

### NexusPHP 架构站点 (如 HDSky, HDDolby)

这类站点通常基于 Cookie 进行认证，RSS 链接中可能会包含用户的 `passkey`，请勿泄露自己的rss订阅！

**步骤：**

1. 登录站点，进入**种子页面 (Torrents)** 或 **首页**。
2. 寻找 RSS 图标或"订阅"链接，通常位于页面右上角会有一个RSS图标（消息通知图标附近）。
3. 选择自己想要订阅的分类（如 剧集），选择清晰度等其他条件，以及选择每页条数，然后点击生成RSS链接。
4. 点击生成的 RSS 链接（一般选择支持RSS订阅功能的BT客户端对应的URL），或者右键复制链接地址。
5. 链接格式通常如下：
   `https://site.com/torrentrss.php?rows=10&linktype=dl&passkey=YOUR_PASSKEY`

**参数说明：**

- `rows`: 返回的种子数量 (建议设置为 10-50)
- `linktype`: 链接类型，通常必须包含 `dl` 以直接获取下载链接
- `passkey`: 你的个人密钥，**请勿泄露**

### mTorrent 架构站点 (如 M-Team)

这类较新的站点通常使用 API Key 或特殊的 RSS 生成页面。

**步骤（以 M-Team 为例）：**

1. 登录站点，进入 **用户中心** 或 **个人设置**。
2. 找到 **API / RSS** 设置部分。
3. 生成一个新的 API Key (如果需要)。
4. 在 RSS 生成器中选择你需要的分类（如 Movie, TV）。
5. 复制生成的链接。
6. 链接格式示例：
   `https://rss.m-team.cc/api/rss/fetch?dl=1&pageSize=10&sign=XXXX&t=XXX&tkeys=ttitle&uid=XXX`

## 在 pt-tools 中配置 RSS

配置 RSS 通常涉及以下几个核心步骤：

1. **准备 RSS 链接**：按照上一节的方法获取。
2. **确定过滤规则**：决定你要下载什么样的种子（例如：只下载免费的、只下载 4K 的）。
3. **设置下载路径**：决定种子下载到哪里。

### 配置示例

在 `pt-tools` Web 管理界面中，选择“站点与RSS”页面，编辑对应的站点，添加一个新的 RSS 任务：

_(注：实际配置字段可能因版本更新略有不同，请以当前版本的配置文档为准)_

## 配置选项详解

| 选项                     | 说明                           | 示例值                       |
| ------------------------ | ------------------------------ | ---------------------------- |
| **名称 (Name)**          | 任务的标识名称，方便管理       | `HDSky-Auto`                 |
| **链接 (URL)**           | 站点的 RSS 地址                | `https://...`                |
| **间隔 (Interval)**      | 多久检查一次更新               | `10m` (10分钟), `1h` (1小时) |
| **下载器 (Downloader)**  | 指定使用的下载客户端           | `qbittorrent-main`           |
| **保存路径 (Save Path)** | 种子数据的下载目录             | `/data/downloads`            |
| **标签 (Category/Tags)** | 添加到下载器的分类标签         | `PT-Auto`                    |
| **免费截止暂停**         | 是否在免费期结束时自动暂停下载 | `true` / `false`             |
| **过滤规则 (Filters)**   | 决定是否下载的逻辑条件         | 见下文                       |

### 常见过滤条件

- **包含关键词 (Include)**: 标题必须包含某些词 (如 `S01`, `1080p`)
- **排除关键词 (Exclude)**: 标题不能包含某些词 (如 `MiniBD`, `Pad`)
- **大小限制 (Size)**: 限制种子的大小范围 (如 `10GB - 50GB`)
- **促销状态 (Promotion)**: 仅下载 `Free`, `2xFree` 等优惠种子

## 最佳实践

1. **合理设置间隔**：不要设置过短的间隔（如小于 5 分钟），以免对站点服务器造成压力导致封号。建议 `10m` 到 `30m`。
2. **先测试后自动**：在正式开启自动下载前，先观察 RSS 抓取的日志，确认过滤规则是否符合预期。
3. **利用站点自身的过滤**：如果站点 RSS 生成器支持选择分类（如只选电影），优先在生成链接时过滤，减少本地处理压力。
4. **分类管理**：为 RSS 下载的任务设置独立的下载器分类（Category），方便后续自动化媒体库管理（如 Jellyfin）。
5. **保护 Passkey**：在分享配置或截图时，务必打码 RSS 链接中的 `passkey` 或 `apikey` 参数。

## 常见问题排查

### 1. RSS 获取失败 (HTTP 403/401)

- **原因**：认证失效或 Passkey 错误。
- **解决**：检查链接中的 passkey 是否正确；如果是需要 Cookie 的站点，确认 pt-tools 中是否配置了有效的站点 Cookie。

### 2. 获取成功但无种子

- **原因**：RSS 链接本身没有返回内容，或者所有内容都被过滤规则拦截了。
- **解决**：
  - 在浏览器中直接打开 RSS 链接，看是否有 XML 内容返回。
  - 检查 `rows` 参数是否太小。
  - 暂时禁用所有过滤规则，看能否抓取到种子。

### 3. 下载器无法添加任务

- **原因**：下载器连接失败、路径不存在或权限不足。
- **解决**：检查下载器配置连通性；确认 `save_path` 在下载器所在的机器上是真实存在且可写的。

### 4. 无法识别促销状态

- **原因**：部分站点的 RSS 不直接包含促销信息，或者工具未适配该站点的特殊字段。
- **解决**：尝试更新 pt-tools 到最新版本；或者依赖站点详情页抓取（如果支持）。

---

[返回首页](../../README.md)
